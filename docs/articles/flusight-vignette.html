<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FluSight Vignette • predx</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="FluSight Vignette">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">predx</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aedes-vignette.html">Aedes Vignette</a>
    </li>
    <li>
      <a href="../articles/flusight-vignette.html">FluSight Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>FluSight Vignette</h1>
                        <h4 class="author">Michael Johansson</h4>
            
            <h4 class="date">2019-04-15</h4>
      
      
      <div class="hidden name"><code>flusight-vignette.Rmd</code></div>

    </div>

    
    
<div id="import-flusight-forecast" class="section level2">
<h2 class="hasAnchor">
<a href="#import-flusight-forecast" class="anchor"></a>Import FluSight forecast</h2>
<p>The <code>import_flusight_csv</code> function uses several helper functions to convert FluSight-specific formatted CSV forecasts. The file name should contain the MMWR epidemiological week assigned to the forecast (e.g. “EW42”) followed by a dash (“-”), the team name (e.g. “Hist_Avg”) followed by a dash (“-”), and the submission date as an ISO data (YYYY-MM-DD, e.g. “2018-10-29”).</p>
<p>This import process creates a special, embedded “<code>predx_df</code>” data frame (a <code>tbl_df</code>, “tibble” object) with a row for every individual prediction (defined by target, location, and prediction type), a column <code>predx_class</code> that defines the class of each prediction, and a column <code>predx</code> that is a list of predx objects. In the process of importation, all predictions are validated (e.g. binned predictions must sum to 1.0) or (hopefully useful) errors messages are returned in the <code>predx</code> column.</p>
<p>For this example, we use a submission with only national-level forecasts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fcast &lt;-<span class="st"> </span><span class="kw"><a href="../reference/flusight.html">import_flusight_csv</a></span>(<span class="st">'EW42-Hist-Avg-2018-10-29-National.csv'</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(fcast)
<span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span>
fcast
<span class="co">#&gt; # A tibble: 14 x 8</span>
<span class="co">#&gt;    location  target unit  team  mmwr_week submission_date predx_class predx</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;       &lt;lis&gt;</span>
<span class="co">#&gt;  1 US Natio~ 1 wk ~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt;  2 US Natio~ 1 wk ~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt;  3 US Natio~ 2 wk ~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt;  4 US Natio~ 2 wk ~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt;  5 US Natio~ 3 wk ~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt;  6 US Natio~ 3 wk ~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt;  7 US Natio~ 4 wk ~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt;  8 US Natio~ 4 wk ~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt;  9 US Natio~ Seaso~ week  Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 10 US Natio~ Seaso~ week  Hist~ 42        2018-10-29      BinCat      &lt;S4:~</span>
<span class="co">#&gt; 11 US Natio~ Seaso~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 12 US Natio~ Seaso~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt; 13 US Natio~ Seaso~ week  Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 14 US Natio~ Seaso~ week  Hist~ 42        2018-10-29      BinCat      &lt;S4:~</span></code></pre></div>
</div>
<div id="verify-expected-predictions-are-included" class="section level2">
<h2 class="hasAnchor">
<a href="#verify-expected-predictions-are-included" class="anchor"></a>Verify expected predictions are included</h2>
<p>The <code>verify_expected</code> function can be used to check that expected targets are included in the <code>predx_df</code>. For example, the national-level FluSight forecasts include forecasts for seven targets and 11 locations. The percentage forecasts (e.g. “Season peak percentage”, “1 wk ahead”) are classified as <code>BinLwr</code> predictions and the week targets (“Season onset”, “Season peak week”) are classifed as <code>BinCat</code> predictions. This set can be specified in a list with one list for each combination of required characteristics. For example, the target “Season peak percentage”, should have a prediction for each location, and each predx class as specified in <code>flusight_ilinet_expected()[[1]]</code>, below.</p>
<pre><code>list(
  list(
    target = c("Season peak percentage", "1 wk ahead", "2 wk ahead", "3 wk ahead", "4 wk ahead"),
    location = c("HHS Region 1", "HHS Region 10", "HHS Region 2", "HHS Region 3",
      "HHS Region 4", "HHS Region 5", "HHS Region 6", "HHS Region 7",
      "HHS Region 8", "HHS Region 9", "US National"),
    predx_class = c("Point", "BinLwr")
  ),
  list(
    target = c("Season onset", "Season peak week"),
    location = c("HHS Region 1", "HHS Region 10", "HHS Region 2", "HHS Region 3",
      "HHS Region 4", "HHS Region 5", "HHS Region 6", "HHS Region 7",
      "HHS Region 8", "HHS Region 9", "US National"),
    predx_class = c("Point", "BinCat")
  )
)</code></pre>
<p>This specific expected list, available with <code>flusight_ilinet_expected</code>, is included in the predx package along with <code>flusight_state_ilinet_expected</code> (for state ILINet forecasts) and <code>flusight_hospitalization_expected</code> (for hospitalization forecasts). Other verification lists can be made in this format and all can be used with the function <code>verify_expected</code> to validate that all expected predictions are included. The function prints missing and additional predictions, but those can also be returned as a data frame by including the argument <code>return_df = TRUE</code>.</p>
<p>For this example, we limit the expected forecasts to the national level.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">national_expected &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(
    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(
      <span class="dt">target =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Season peak percentage"</span>, <span class="st">"1 wk ahead"</span>, <span class="st">"2 wk ahead"</span>, <span class="st">"3 wk ahead"</span>, <span class="st">"4 wk ahead"</span>),
      <span class="dt">location =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"US National"</span>),
      <span class="dt">predx_class =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Point"</span>, <span class="st">"BinLwr"</span>)
    ),
    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(
      <span class="dt">target =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Season onset"</span>, <span class="st">"Season peak week"</span>),
      <span class="dt">location =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"US National"</span>),
      <span class="dt">predx_class =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Point"</span>, <span class="st">"BinCat"</span>)
    )
  )

<span class="kw"><a href="../reference/verify_expected.html">verify_expected</a></span>(fcast, national_expected)
<span class="co">#&gt; All expected predictions found.</span></code></pre></div>
</div>
<div id="export-as-predx-json-reduced-size-predx-csv-or-flusight-csv" class="section level2">
<h2 class="hasAnchor">
<a href="#export-as-predx-json-reduced-size-predx-csv-or-flusight-csv" class="anchor"></a>Export as predx JSON (reduced size), predx CSV, or FluSight CSV</h2>
<p>To save space and facilitate sharing, transfer, and storage of <code>predx_df</code> objects, they can be exported as JSON objects using the function <code>export_json</code>. A file name can be supplied as an argument to store this as a file instead of returning an object as shown for the first two predictions in <code>fcast</code> below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/export_json.html">export_json</a></span>(fcast[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ])
<span class="co">#&gt; [{"location":"US National","target":"1 wk ahead","unit":"percent","team":"Hist-Avg","mmwr_week":"42","submission_date":"2018-10-29","predx_class":"Point","predx":{"point":[1.3]}},{"location":"US National","target":"1 wk ahead","unit":"percent","team":"Hist-Avg","mmwr_week":"42","submission_date":"2018-10-29","predx_class":"BinLwr","predx":{"lwr":[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7,4.8,4.9,5,5.1,5.2,5.3,5.4,5.5,5.6,5.7,5.8,5.9,6,6.1,6.2,6.3,6.4,6.5,6.6,6.7,6.8,6.9,7,7.1,7.2,7.3,7.4,7.5,7.6,7.7,7.8,7.9,8,8.1,8.2,8.3,8.4,8.5,8.6,8.7,8.8,8.9,9,9.1,9.2,9.3,9.4,9.5,9.6,9.7,9.8,9.9,10,10.1,10.2,10.3,10.4,10.5,10.6,10.7,10.8,10.9,11,11.1,11.2,11.3,11.4,11.5,11.6,11.7,11.8,11.9,12,12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,12.9,13],"prob":[0,1.1666388623852e-017,1.46385383132117e-017,6.8045592093287e-018,3.02327144416287e-018,2.61294928844424e-018,3.77969092087992e-018,8.29760329851558e-012,2.4568991845654e-005,0.0116785404949,0.0285039127629738,0.0884106008943569,0.204968823307941,0.284619990086954,0.199478680040742,0.0529871304492426,0.0107502427678402,0.0228725805968266,0.0172427873617089,0.000722069388890097,0.000646487092286736,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286735,0.000646487092286734,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.000646487092286737,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00064648709228674,0.00662649269593905]}}]</span>
json_tempfile =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempfile</a></span>()
<span class="kw"><a href="../reference/export_json.html">export_json</a></span>(fcast, <span class="dt">filename =</span> json_tempfile, <span class="dt">overwrite =</span> T)</code></pre></div>
<p>Alternatively, <code>predx_df</code> objects can be exported as predx CSV files or FluSight-formatted CSV files (those used for submissions on the FluSight website). These CSV formats differ in several ways:</p>
<ol style="list-style-type: decimal">
<li>The <code>predx</code> CSV contains additional columns for MMWR epidemic week, team, and submission date. In the FluSight CSV these are included in the file name only.</li>
<li>The <code>predx</code> CSV includes point predictions as individual rows whereas the FluSight CSV includes them in an additional column.</li>
<li>The FluSight CSV will allow upload on the EPI webpage.</li>
</ol>
<p>These differences are the results of making <code>predx</code> JSON and CSV formats more generic than the specific FluSight implementation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">csv_tempfile &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempfile</a></span>()
<span class="kw"><a href="../reference/export_csv.html">export_csv</a></span>(fcast, <span class="dt">filename =</span> csv_tempfile, <span class="dt">overwrite =</span> T)
<span class="kw"><a href="../reference/flusight.html">export_flusight_csv</a></span>(fcast[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ])
<span class="co">#&gt; # A tibble: 132 x 7</span>
<span class="co">#&gt;    location   target   type  unit   bin_start_incl bin_end_notincl    value</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 US Nation~ 1 wk ah~ Point perce~           NA             NA    1.30e+ 0</span>
<span class="co">#&gt;  2 US Nation~ 1 wk ah~ Bin   perce~            0              0.1  0.      </span>
<span class="co">#&gt;  3 US Nation~ 1 wk ah~ Bin   perce~            0.1            0.2  1.17e-17</span>
<span class="co">#&gt;  4 US Nation~ 1 wk ah~ Bin   perce~            0.2            0.3  1.46e-17</span>
<span class="co">#&gt;  5 US Nation~ 1 wk ah~ Bin   perce~            0.3            0.4  6.80e-18</span>
<span class="co">#&gt;  6 US Nation~ 1 wk ah~ Bin   perce~            0.4            0.5  3.02e-18</span>
<span class="co">#&gt;  7 US Nation~ 1 wk ah~ Bin   perce~            0.5            0.6  2.61e-18</span>
<span class="co">#&gt;  8 US Nation~ 1 wk ah~ Bin   perce~            0.6            0.7  3.78e-18</span>
<span class="co">#&gt;  9 US Nation~ 1 wk ah~ Bin   perce~            0.7            0.80 8.30e-12</span>
<span class="co">#&gt; 10 US Nation~ 1 wk ah~ Bin   perce~            0.8            0.9  2.46e- 5</span>
<span class="co">#&gt; # ... with 122 more rows</span></code></pre></div>
</div>
<div id="import-predx-json-or-predx-csv" class="section level2">
<h2 class="hasAnchor">
<a href="#import-predx-json-or-predx-csv" class="anchor"></a>Import predx JSON or predx CSV</h2>
<p>In addition to importing CSV files in the FluSight format (as described at the beginning of this vignette), <code>predx</code> can be used to import <code>predx</code> JSON or <code>predx</code> CSV files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fcast &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import_json.html">import_json</a></span>(json_tempfile)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(fcast)
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   location  target  unit  team  mmwr_week submission_date predx_class predx</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;       &lt;lis&gt;</span>
<span class="co">#&gt; 1 US Natio~ 1 wk a~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 2 US Natio~ 1 wk a~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt; 3 US Natio~ 2 wk a~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 4 US Natio~ 2 wk a~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt; 5 US Natio~ 3 wk a~ perc~ Hist~ 42        2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 6 US Natio~ 3 wk a~ perc~ Hist~ 42        2018-10-29      BinLwr      &lt;S4:~</span>
fcast_csv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import_csv.html">import_csv</a></span>(csv_tempfile)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(fcast_csv)
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   location  target  unit  team  mmwr_week submission_date predx_class predx</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;       &lt;lis&gt;</span>
<span class="co">#&gt; 1 US Natio~ 1 wk a~ perc~ Hist~        42 2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 2 US Natio~ 1 wk a~ perc~ Hist~        42 2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt; 3 US Natio~ 2 wk a~ perc~ Hist~        42 2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 4 US Natio~ 2 wk a~ perc~ Hist~        42 2018-10-29      BinLwr      &lt;S4:~</span>
<span class="co">#&gt; 5 US Natio~ 3 wk a~ perc~ Hist~        42 2018-10-29      Point       &lt;S4:~</span>
<span class="co">#&gt; 6 US Natio~ 3 wk a~ perc~ Hist~        42 2018-10-29      BinLwr      &lt;S4:~</span></code></pre></div>
</div>
<div id="use-with-the-flusight-package" class="section level2">
<h2 class="hasAnchor">
<a href="#use-with-the-flusight-package" class="anchor"></a>Use with the FluSight package</h2>
<p>The <code>FluSight</code> package <a href="">https://github.com/jarad/FluSight</a> includes numerous functions to work with forecasts, such as scoring and visualization. <code>predx</code> FluSight forecast can be converted to the format used by the <code>FluSight</code> package using <code>to_flusight_pkg_format</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fcast_flusight &lt;-<span class="st"> </span><span class="kw"><a href="../reference/flusight.html">to_flusight_pkg_format</a></span>(fcast)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(fcast_flusight)
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;   location target type  unit  bin_start_incl bin_end_notincl    value</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt; 1 US Nati~ 1 wk ~ Point perc~ &lt;NA&gt;           &lt;NA&gt;            1.30e+ 0</span>
<span class="co">#&gt; 2 US Nati~ 1 wk ~ Bin   perc~ 0.0            0.1             0.      </span>
<span class="co">#&gt; 3 US Nati~ 1 wk ~ Bin   perc~ 0.1            0.2             1.17e-17</span>
<span class="co">#&gt; 4 US Nati~ 1 wk ~ Bin   perc~ 0.2            0.3             1.46e-17</span>
<span class="co">#&gt; 5 US Nati~ 1 wk ~ Bin   perc~ 0.3            0.4             6.80e-18</span>
<span class="co">#&gt; 6 US Nati~ 1 wk ~ Bin   perc~ 0.4            0.5             3.02e-18</span>
<span class="co">#&gt; # ... with 1 more variable: forecast_week &lt;dbl&gt;</span></code></pre></div>
<p>This can then be used for scoring. Note that in this example, <code>fcast</code> only contains national level forecasts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(FluSight)
truth_<span class="dv">1819</span> &lt;-<span class="st"> </span>FluSight<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/FluSight/topics/create_truth">create_truth</a></span>(<span class="dt">year =</span> <span class="dv">2018</span>)
truth_<span class="dv">1819</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(truth_<span class="dv">1819</span>, location <span class="op">==</span><span class="st"> 'US National'</span>)
FluSight<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/FluSight/topics/score_entry">score_entry</a></span>(fcast_flusight, truth_<span class="dv">1819</span>)
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt;   location    target                 score forecast_week</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 US National Season onset           -2.41            42</span>
<span class="co">#&gt; 2 US National Season peak week       -2.11            42</span>
<span class="co">#&gt; 3 US National Season peak percentage -3.96            42</span>
<span class="co">#&gt; 4 US National 1 wk ahead             -4.53            42</span>
<span class="co">#&gt; 5 US National 2 wk ahead             -3.16            42</span>
<span class="co">#&gt; 6 US National 3 wk ahead             -3.71            42</span>
<span class="co">#&gt; 7 US National 4 wk ahead             -2.99            42</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#import-flusight-forecast">Import FluSight forecast</a></li>
      <li><a href="#verify-expected-predictions-are-included">Verify expected predictions are included</a></li>
      <li><a href="#export-as-predx-json-reduced-size-predx-csv-or-flusight-csv">Export as predx JSON (reduced size), predx CSV, or FluSight CSV</a></li>
      <li><a href="#import-predx-json-or-predx-csv">Import predx JSON or predx CSV</a></li>
      <li><a href="#use-with-the-flusight-package">Use with the FluSight package</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Johansson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
